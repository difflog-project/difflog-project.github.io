---
title: 'Nichrome: A Solver for Mixed Hard and Soft Constraints'
layout: default
---

<div class="row">
	<div class="page-header" class="col-lg-12">
		<h4>Setup</h4>
	</div>
	<div class="col-lg-12">
		<p>To use <b>{{site.toolname}}</b>, we need to first install and configure the PostgreSQL database, and provide a configuration file to help <b>{{site.toolname}}</b> find the software it depends on.</p>
		<ol>
			<li>Install PostgreSQL.
			<p>
				<a href="http://www.postgresql.org/ftp/source/v9.3.4/">Download</a> and unpack the source of PostgreSQL.
				Let <i>PG_DIST</i> be the path where the source is unpaked and <i>PG_INSTALL</i> be the path where
				you want PostgreSQL to be installed, then build and install PostgreSQL as follows:				
			</p>				

<pre><code>cd PG_DIST 							
./configure â€“prefix=PG_INSTALL
make; make install 
cd PG_DIST/contrib/intarray 
make; make install				
cd PG_DIST/contrib/intagg 
make; make install</code></pre>
			<p>
				Then configure PostgreSQL as follows:
<pre><code>cd PG_INSTALL/bin
./initdb -D ../data
./pg_ctl -D ../data/ -l ../log  start
./createuser -s -P {{site.toolname}}
# Provide a password you like, e.g., {{site.toolname}}
./createdb {{site.toolname}}db
</code></pre>
				</p>
			</li>
			<li>Define a configuration file.
<p>Below is an example configuration file, which we will refer to as "{{site.toolname}}.conf".</p>
<pre><code>db_url = jdbc:postgresql://localhost:5432/{{site.toolname}}db

# Database username; must be a superuser
db_username = {{site.toolname}}

# The password for db_username
db_password = {{site.toolname}}

# The working directory; {{site.toolname}} may write sizable temporary data here
dir_working = &#60;work-dir&#62;

maxsat = &#60;path of the MaxSAT solver&#62;
lbx = &#60;path of lbx&#62;
mcsls = &#60;path of mcsls&#62;</code></pre>
			</li>
		</ol>
	</div>
</div>

<div class="row">
	<div class="page-header" class="col-lg-12">
		<h4>Inference</h4>
	</div>
	<div class="col-lg-12">
		<p><b>{{site.toolname}}</b> currently supports <a href="https://en.wikipedia.org/wiki/Maximum_a_posteriori_estimation">MAP</a> inference for MLN programs.
			Below is an example MLN program for the graph reachability problem, which we refer to as "graph.mln"
		</p>
		<pre>
// graph.mln
// Define the relations. The "*" means closed-world assumption holds for the specified relation. Otherwise, open-world assumption is applied.
*edge(node,node)
path(node,node)

// Reflexivity
path(n,n).
// If there is a edge from n1 to n2, and there is a path from n2 to n3, then there is a path from n1 to n3. 
// This rule can also be written as 
// !edge(n1,n2) v !path(n2,n3) v path(n1,n3)
edge(n1,n2),path(n2,n3) => path(n1,n3).

// Least-fix-point contraint. Do not derive unnecessary paths.
1 !path(n1,n2)</pre>
	<p>
		The file below ("graph.edb") is an input file which defines a graph a --> b --> c.
	</p>

<pre>
// graph.edb
edge(a,b)
edge(b,c)
</pre>
	<p>
		To solve the graph reachability on the graph defined above, we run {{site.toolname}} using the command below:
<pre>
java -jar {{site.toolname}}.jar -conf {{site.toolname}}.conf -e graph.edb  -r result.txt  -i graph.mln -verbose 2 -solver lbxmcs  -lbxTimeout 18000 -lbxLimit 1 -printVio > log.txt
</pre>
{{site.toolname}} will output the result to "result.txt". Below is the content of it after runing the above command.
	</p>
<pre>
// 0 Optimum value: 3.0
// 1 The following variables should be set to true: 
edge(a,b)
edge(b,c)
path(a,a)
path(b,b)
path(c,c)
path(b,c)
path(a,b)
path(a,c)

// 2 The following grounded clauses are not satified: 
// 1.0: NOT path(a,a)
// 1.0: NOT path(b,b)
// 1.0: NOT path(c,c)
// 1.0: NOT path(b,c)
// 1.0: NOT path(a,b)
// 1.0: NOT path(a,c)	
</pre>
<p>For details about the command options, please run "java -jar {{site.toolname}}.jar -help".</p>
	</div>
</div>

<div class="row">
	<div class="page-header" class="col-lg-12">
		<h4>Learning</h4>
	</div>
	<div class="col-lg-12">
		Coming soon.
	</div>
</div>
